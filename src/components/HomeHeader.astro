---
import Container from "@components/Container.astro";
import ResponsiveMenu from "@components/ResponsiveMenu.astro";
import logo from "@images/logo_jbee_off-white.svg";
import headerImage from "@images/header_image.jpg";
import "@styles/global.css";
import { Image } from "astro:assets";
---

<script>
  import { jarallax } from "jarallax";

  // Attendre les images avant d'initialiser (réduit CLS)
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initParallax);
  } else {
    initParallax();
  }

  function initParallax() {
    const elements = document.querySelectorAll(".jarallax");
    if (elements.length) {
      // Déférer après layout avec RAF
      requestAnimationFrame(() => {
        jarallax(elements, {
          speed: 0.5,
          // Désactiver sur mobile (performance + réduit CLS)
          disableParallax: /iPad|iPhone|iPod|Android/.test(navigator.userAgent),
        });
      });
    }
  }
</script>
<header
  role="banner"
  data-jarallax
  data-speed="0.5"
  class="header jarallax relative z-50 flex w-full flex-col overflow-hidden sm:min-h-[300px] md:min-h-[400px]">
  <Container class="relative my-auto flex flex-1 justify-center" style="contain: layout; min-height: 400px;">
    <Image
      class="jarallax-img absolute left-0 top-0 -z-10 h-full w-full object-cover object-center"
      src={headerImage}
      alt=""
      width={1600}
      height={600}
      format="webp"
      loading="eager"
      fetchpriority="high"
      sizes="(max-width: 600px) 480px, (max-width: 1024px) 1024px, 1600px"
    />
    <div class="flex items-center justify-center" style="aspect-ratio: 2/1; width: 100%; max-width: 32rem;">
      <h1 class="sr-only">Julien Bruneel - Développeur web</h1>
      <Image
        src={logo}
        class="w-full max-w-sm p-8"
        alt="Julien Bruneel développeur web - Retour à l'accueil"
        width={600}
        height={300}
      />
    </div>
  </Container>
  <div class="mt-auto">
    <ResponsiveMenu isHomePage />
  </div>
</header>
