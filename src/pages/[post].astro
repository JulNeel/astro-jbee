---
import CKEditorContent from "@components/CKEditorContent.astro";
import Container from "@components/Container.astro";
import Layout from "@layouts/Layout.astro";
import { Image } from "astro:assets";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const allPosts = await getCollection("posts");

  return allPosts.map((post) => {
    return {
      params: {
        post: post.data.slug,
      },
      props: {
        post,
      },
    };
  });
}

const { post } = Astro.props;
---

<Layout
  title={`${post.data.title} | JBee`}
  description={post.data.excerpt || "Article sur le dÃ©veloppement web"}
  image={post.data.coverImage?.url}
  type="article">
  <main>
    <Container class="flex flex-col items-center gap-4 py-8" variant="narrow">
      <h1>{post?.data?.title}</h1>
      {
        post?.data?.coverImage && (
          <Image
            src={post.data.coverImage.url}
            alt={post.data.coverImage.altText}
            width={896}
            height={504}
            class="h-auto w-full rounded-lg"
          />
        )
      }
      <CKEditorContent content={post?.data?.content || ""} />
    </Container>
  </main>
</Layout>
